<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>采购报价比价助手</title>

  <!-- ✅ 样式：Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />

  <!-- ✅ 插件依赖：图表、导出功能 -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.1.3/docx.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>

<body class="bg-gray-100 text-gray-900 p-6 font-sans">
  <div class="max-w-4xl mx-auto space-y-6">

    <!-- 标题区域 -->
    <div class="text-center">
      <h1 class="text-3xl font-semibold">采购报价比价助手</h1>
      <p class="text-sm text-gray-600 mt-2" id="exchange-rate">加载中汇率...</p>
    </div>

    <!-- 报价输入 -->
    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
      <h2 class="text-lg font-medium mb-4">报价信息录入</h2>
      <form id="quote-form" class="space-y-3">
        <div class="grid grid-cols-7 gap-2 items-center">
          <input placeholder="供应商" class="col-span-1 border p-2 rounded" />
          <input placeholder="产品" class="col-span-1 border p-2 rounded" />
          <input placeholder="单价" type="number" class="col-span-1 border p-2 rounded" />
          <select class="col-span-1 border p-2 rounded">
            <option>CNY</option>
            <option>USD</option>
            <option>EUR</option>
            <option>JPY</option>
            <option>HKD</option>
          </select>
          <input placeholder="交期(天)" type="number" class="col-span-1 border p-2 rounded" />
          <input placeholder="备注" class="col-span-1 border p-2 rounded" />
          <button type="button" class="bg-red-100 text-red-600 px-2 py-1 rounded">删除</button>
        </div>
        <button type="button" id="add-row" class="mt-2 bg-blue-500 text-white px-4 py-2 rounded">➕ 添加供应商</button>
      </form>
    </div>

    <!-- 权重设置 -->
    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
      <h2 class="text-lg font-medium mb-4">评分权重设置</h2>
      <div class="flex flex-wrap gap-6 items-center">
        <div class="flex items-center space-x-2">
          <label for="weight-price" class="text-sm text-gray-600">价格权重（%）</label>
          <input id="weight-price" type="number" class="border p-1.5 rounded w-28" />
        </div>
        <div class="flex items-center space-x-2">
          <label for="weight-delivery" class="text-sm text-gray-600">交期权重（%）</label>
          <input id="weight-delivery" type="number" class="border p-1.5 rounded w-28" />
        </div>
      </div>
      <p class="text-xs text-gray-500 mt-2">不填写时，默认价格占 60%，交期占 40%</p>
    </div>

    <!-- 操作按钮 -->
    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
      <h2 class="text-lg font-medium mb-4">操作区域</h2>
      <div class="flex flex-wrap gap-4">
        <button id="generate" class="bg-green-600 text-white px-6 py-2 rounded text-lg hover:bg-green-700">📊 生成对比图</button>
        <button id="export-word" class="bg-gray-800 text-white px-4 py-2 rounded hover:bg-gray-700">⬇️ 导出为 Word</button>
        <button id="export-excel" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">⬇️ 导出为 Excel</button>
      </div>
    </div>

    <!-- 图表展示 -->
    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
      <h2 class="text-lg font-medium mb-4">评分对比图</h2>
      <canvas id="price-chart" class="h-64"></canvas>

      <p class="text-xs text-gray-500 mt-4 leading-relaxed border-t pt-3">
        <strong>评分说明：</strong><br>
        综合得分 = 价格得分 × 权重 + 交期得分 × 权重。<br><br>
        - 价格得分 = 100 - （该报价 - 最低报价）÷（最高报价 - 最低报价）× 100<br>
        - 交期得分 = 100 - （该交期 - 最快交期）÷（最慢交期 - 最快交期）× 100<br><br>
        ✅ 分数越高，表示综合性价比越优，仅供参考。
      </p>
    </div>
  </div>

  <!-- 页面逻辑脚本 -->
  <script src="main.js"></script>
</body>
</html>
